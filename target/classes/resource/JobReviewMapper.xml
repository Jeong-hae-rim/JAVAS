<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="resource.JobReviewMapper">
	<select id="selectJobReview" resultType="vo.JobReviewVO">
		select review_id,
		post_id, review_userid,
		review_comment, review_date, review_rate from
		jobreview order by post_id
	</select>
	<select id="selectJobReviewById" parameterType="_int" resultType="vo.JobReviewVO">
		select review_id, review_userid,
		review_comment, review_date 
		from jobreview where post_id = #{post_id} 
		order by review_id
	</select>
	<delete id="deleteJobReview" parameterType="_int">
		delete from jobreview
		where review_id=#{review_id}
	</delete>
	<insert id="insertJobReview" parameterType="vo.JobReviewVO">
		insert into jobreview
		(post_id, review_userid,
		review_comment, review_date, review_rate)
		values
		(#{post_id}, #{review_userid},
		#{review_comment}, sysdate, #{review_rate})
	</insert>
	<update id="updateJobReivew" parameterType="vo.JobadVO">
		update jobreview set
		review_comment = #{review_comment},
		review_date = #{review_date},
		review_rate = #{review_rate}
		where review_id = #{review_id}
	</update>
	<update id="updateJobReviewCount" parameterType="_int">
		update jobad set
		post_review_count = post_review_count + 1 
		where post_id=#{post_id}
	</update>
	<update id="updateJobReviewCount2" parameterType="_int">
		update jobad set
		post_review_count = post_review_count - 1 
		where post_id=#{post_id}
	</update>
</mapper>