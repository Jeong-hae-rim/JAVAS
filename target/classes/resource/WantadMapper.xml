<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="resource.WantadMapper">
	<select id="selectWantad" resultType="vo.WantadVO">
		select post_id, mem_userid,
		post_title, post_content, post_writedate, post_hit,
		post_location,
		post_payment, post_review_count from wantad order by post_id desc
	</select>
	<select id="selectWantadLocation" resultType="vo.WantadLocVO">
		select post_id, post_location from wantad order by post_id desc
	</select>
	<select id="selectWantadPage" parameterType="java.util.Map"
		resultType="vo.WantadVO">
		select post_id, mem_userid, post_title, post_content, post_writedate,
		post_hit,
		post_location, post_payment, post_review_count
		from (select
		post_id, mem_userid, post_title, post_content,
		post_writedate,
		post_hit,
		post_location, post_payment, post_review_count, rownum as
		rnum
		from wantad order by post_id desc)
		where rnum between ${beginNum} and ${endNum} order by post_id desc
	</select>
	<select id="selectWantad1" parameterType="_int"
		resultType="vo.WantadVO">
		select post_id, mem_userid, post_title, post_content,
		post_writedate, post_hit,
		post_location, post_payment,
		post_review_count from wantad where post_id =
		#{post_id}
	</select>
	<select id="searchWantadTitleAndContent1"
		parameterType="java.util.Map" resultType="vo.WantadVO">
		select mem_userid,
		post_title, post_content, post_writedate, post_hit,
		post_location,
		post_payment, post_review_count from wantad
		where ${searchtype} like
		'%'||#{key}||'%'
	</select>
	<select id="searchWantadAll1" parameterType="string"
		resultType="vo.WantadVO">
		select mem_userid, post_title, post_content,post_writedate, 
		post_hit, post_location, post_payment, post_review_count from wantad
		where post_title like '%'||#{key}||'%'
		union
		select mem_userid, post_title, post_content, post_writedate,
		post_hit, post_location, post_payment, post_review_count from wantad
		where post_content like '%'||#{key}||'%'
		union
		select mem_userid, post_title, post_content, post_writedate,
		post_hit, post_location, post_payment, post_review_count from wantad
		where post_location like '%'||#{key}||'%'
	</select>

	<select id="searchWantad1" parameterType="string"
		resultType="vo.WantadVO">
		select mem_userid, post_title, post_content,
		post_writedate, post_hit,
		post_location, post_payment,
		post_review_count from wantad
		where mem_userid =
		#{mem_userid} order by
		post_id
	</select>
	<delete id="deleteWantad" parameterType="_int">
		delete from wantad where
		post_id = #{post_id}
	</delete>
	<insert id="insertWantad" parameterType="vo.WantadVO">
		insert into wantad
		(mem_userid, post_title, post_content, post_writedate,
		post_location,
		post_payment, post_review_count, post_hit)
		values (#{mem_userid},
		#{post_title}, #{post_content}, sysdate,
		#{post_location},
		#{post_payment}, #{post_review_count}, 0)
	</insert>
	<update id="updateWantad" parameterType="vo.WantadVO">
		update wantad set
		mem_userid = #{mem_userid}, post_title = #{post_title},
		post_content =
		#{post_content}, post_writedate = sysdate where post_id =
		#{post_id}
	</update>
	<update id="updateWantadView" parameterType="_int">
		update wantad set
		post_hit = post_hit + 1 where post_id = #{post_id}
	</update>
	<select id="searchWantadTitleAndContent"
		parameterType="java.util.Map" resultType="vo.WantadVO">
		select post_id, mem_userid,
		post_title, post_content, post_writedate,
		post_hit, post_location,
		post_payment, post_review_count
		from
		(select post_id, mem_userid, post_title,
		post_content, post_writedate, post_hit, post_location,
		post_payment, post_review_count, rownum as rnum
		from wantad where ${searchtype} like
		'%'||#{key}||'%'
		order by post_id desc)
		where rnum between to_number(${beginNum}) and
		to_number(${endNum})
		order by post_id desc
	</select>
	<select id="searchWantadAll" parameterType="java.util.Map"
		resultType="vo.WantadVO">
		select rownum, rnum, post_id, mem_userid, post_title, post_content,
		post_writedate,
		post_hit, post_location, post_payment, post_review_count
		from(
		select rownum as rnum, post_id, mem_userid, post_title, post_content,
		post_writedate,
		post_hit, post_location, post_payment, post_review_count
		from
		(select post_id, mem_userid, post_title,
		post_content, post_writedate, post_hit, post_location,
		post_payment, post_review_count
		from wantad where post_title like '%'||#{key}||'%'
		union
		select post_id, mem_userid, post_title,
		post_content, post_writedate, post_hit, post_location,
		post_payment, post_review_count
		from wantad where post_content like '%'||#{key}||'%'
		union
		select post_id, mem_userid, post_title,
		post_content, post_writedate, post_hit, post_location,
		post_payment, post_review_count
		from wantad where post_location like '%'||#{key}||'%'
		)
		order by post_id desc)
		where rnum between to_number(${beginNum}) and to_number(${endNum})
		order by post_id desc

	</select>
	<select id="searchWantaduserid" parameterType="java.util.Map"
		resultType="vo.WantadVO">
		select post_id, mem_userid, post_title, post_content,
		post_writedate,
		post_hit, post_location, post_payment,
		post_review_count
		from
		(select post_id, mem_userid, post_title,
		post_content, post_writedate, post_hit, post_location,
		post_payment, post_review_count, rownum as rnum
		from wantad where
		mem_userid=#{mem_userid}
		order by post_id desc)
		where rnum between to_number(${beginNum}) and
		to_number(${endNum})
		order by post_id desc
	</select>
	<select id="countWantad" resultType="_int">
		select count(post_id) from
		wantad
	</select>
	<select id="countWantaduserid" parameterType="string"
		resultType="_int">
		select count(post_id) from wantad where
		mem_userid=#{mem_userid}
	</select>
	<select id="countWantadsearch" parameterType="java.util.Map"
		resultType="_int">
		select count(post_id) from wantad where ${searchtype} like
		'%'||#{key}||'%'
	</select>
	<select id="countWantadsearchall" parameterType="string"
		resultType="_int">
		select count(post_id) from
		(select post_id from wantad where post_title like '%'||#{key}||'%'
		union
		select post_id from wantad where post_content like '%'||#{key}||'%'
		union
		select post_id from wantad where post_location like '%'||#{key}||'%'
		)
	</select>

</mapper>